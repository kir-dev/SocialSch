# Workflows

## Git 

### Branch Management

1. Create a new branch for your feature or bugfix
   ```bash
   git checkout -b <branch-name>
   ```
2. Make your changes and commit them
   ```bash
    git add *
    git commit -m "Your commit message"
    ```
   
3. Push your changes to the remote repository
   ```bash
   git push origin <branch-name>
   # or if the origin is already set
   git push   
   ```
   
4. Create a pull request to merge your changes into the main branch

## Backend

### Creating a new entity

1. Make changes to the `schema.prisma` file.

2. Create a migration based on the changes.
   ```bash
   pnpm prisma migrate dev --name <migration-name>
   ```
   
3. Generate the Prisma client (this creates the typescript types).
   ```bash
    pnpm prisma generate
    ```

4. Create a new Nest resource .
   ```bash
   pnpm nest g resource <resource-name>
   ```
   Select the REST API option and select yes for the CRUD option.

   If the command is not found, install the Nest CLI globally.
   ```bash
    pnpm install -g @nestjs/cli
    ```
   
5. Define the endpoints in the controller file.
   [Reference](https://docs.nestjs.com/controllers)

6. Implement the service file.
   [Help](https://docs.nestjs.com/recipes/prisma) for using Prisma in the service file
   You can use the types generated by Prisma, import them from `@prisma/client`.
   ```typescript
    import { User } from '@prisma/client';
    ```
   
7. Create the DTOs (Data Transfer Objects) for the entity.
   Good examples:
   [Entity](https://github.com/kir-dev/schbody/blob/main/apps/backend/src/posts/entities/post.entity.ts).
   [CreateDto](https://github.com/kir-dev/schbody/blob/main/apps/backend/src/posts/dto/create-post.dto.ts).
   [UpdateDto](https://github.com/kir-dev/schbody/blob/main/apps/backend/src/posts/dto/update-post.dto.ts).
   
   The `OmitType` class is used to create a new class that omits the given fields from the given entity.
   The `PartialType` class is used to create a new class that makes all the fields of the given entity optional.

   For the validation to work, the global validation pipe has to be enabled in the `main.ts` file.
   [Reference](https://docs.nestjs.com/pipes#validation-pipes).


## Frontend

### Good resources

[Next.js docs](https://nextjs.org/docs/getting-started)
[React docs](https://react.dev/learn)

[Next.js layout docs](https://nextjs.org/docs/app/getting-started/layouts-and-pages)

[Data fetching](https://nextjs.org/docs/app/getting-started/fetching-data)
You can start working with the built-in `fetch` function, but we prefer using `axios` for data fetching.
If you would like to do some advanced data fetching, you can use `react-query` or `swr`.
[React Query](https://tanstack.com/query/latest/docs/framework/react/installation)
[SWR](https://swr.vercel.app/docs/getting-started)

I think using `swr` is better with Next.js.

You don't have to use neither of them, but they are very useful for data fetching, since they provide caching, 
revalidation, and automatic refetching of the data.

### Tech stack

- [Tailwind](https://tailwindcss.com/docs/styling-with-utility-classes) for styling
- [shadcn/ui](https://ui.shadcn.com/docs/components/button) for components

If you need to create a new UI, I recommend to look at the shadcn/ui components, many of them have already been implemented.
Every component has a short description and a code example, then you can install in inside the `apps/frontend` folder, then style it however you like.